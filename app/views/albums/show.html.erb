<h2><%= @album.name %> - <small><%= @album.description %></small></h2>

<label><h5>by <label><%= @author_name %></label></h5></label>

<br/>

<% if user_signed_in? %>
  <% if ((can? :edit, @album) && (@album.user_id == current_user.id  || current_user.role?(:admin) ))  %>
    <%= link_to(edit_album_path(@album), class: "button-sm") do %>
      <i class="icon-edit"></i> Edit
    <% end %>
  <% end %>
<% end %>

<% if @current_album_type.name.singularize == 'Picture' %>
  <%= link_to(new_picture_path(:imageable_id => @album.id, :imageable_type => 'Album'), class: "button-sm") do %>
    <i class="icon-add"></i> Add <%= @current_album_type.name.singularize %>
  <% end %>
<% end %>

<%= link_to(album_path(@album, :view => 'carousel'), class: "button-sm") do %>
  <i class="icon-view"></i> Carousel
<% end %>

<%= link_to(album_path(@album), class: "button-sm") do %>
  <i class="icon-view"></i> Thumbnails
<% end %>

<hr/>

<% if params["view"] == 'carousel' %>
  <%= render partial: 'carousel', locals: { album_pictures: @album_pictures } %>
<% else %>
  <label><em>(click image to view original size)</em></label>
  <div class="row">
    <% @album_pictures.order('date_taken').each do |picture| %>
      <div class="col-xs-6 col-md-4">
          <div class="thumbnail">
            <% if ((can? :edit, picture) && (picture.user_id == current_user.id || current_user.role?(:admin) )) %>
              <%= link_to(edit_picture_path(picture, :album_id => @album.id, :imageable_id => @album.id, :imageable_type => 'Album'),
                class: "button-sm") do %>
                <i class="icon-edit"></i>
              <% end %>
            <% end %>
            <% if ((can? :destroy, picture) && (@album.user_id == current_user.id || current_user.role?(:admin) )) %>
              <%= link_to(picture, class: "button-sm-danger",
                :data => { :confirm => "Are you sure you want to delete #{picture.name}?" }, :method => :delete) do %>
                <i class="icon-delete"></i>
              <% end %>
            <% end %>
            <%= link_to(picture_path(picture)) do %>
              <img
                src="<%= url_for(:action => 'thumbnail', :id => picture.id, :controller => 'pictures', :height => 200, :width => 300) %>"
                alt="<%= picture.name %>"
                title="<%= picture.name %>"
              />
            <% end %>
            <div class="caption">
              <h4><%= picture.description %></h4>
              <h5><%= picture.date_taken %></h5>
            </div>
          </div>
      </div>
    <% end %>
  </div>
<% end %>

<div class="field">
  <%= will_paginate @album_pictures, renderer: BootstrapPagination::Rails %>
</div>

<%= link_to(albums_path(:album_type => @current_album_type.id), class: "button-sm") do %>
  <i class="icon-list"></i> List <%= @current_album_type.name.singularize %> Albums
<% end %>
